(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{124:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),i=n(10),c=n.n(i),s=(n(124),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,217)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))}),u=n(17),o=n(25),l=n(105),j=n(19),b=n(13),d=function(e){return{loggedIn:e.session.isAuthenticated}},h=Object(b.i)(Object(u.b)(d)((function(e){var t=e.component,n=e.path,a=e.loggedIn,i=e.exact;return Object(r.jsx)(b.b,{path:n,exact:i,render:function(e){return a?Object(r.jsx)(b.a,{to:"/"}):Object(r.jsx)(t,Object(j.a)({},e))}})}))),p=Object(b.i)(Object(u.b)(d)((function(e){var t=e.component,n=e.loggedIn,a=Object(l.a)(e,["component","loggedIn"]);return Object(r.jsx)(b.b,Object(j.a)(Object(j.a)({},a),{},{render:function(e){return n?Object(r.jsx)(t,Object(j.a)({},e)):Object(r.jsx)(b.a,{to:"/"})}}))}))),f=n(212),g=n(50),m=n(208),O=n(30),x=n.n(O),v="RECEIVE_ALBUM",y="RECEIVE_ALL_ALBUMS",I="REMOVE_ALBUM",w=function(e){return{type:v,album:e}},C=function(e){return function(t){return function(e){return x.a.post("/api/albums",e)}(e).then((function(e){return t(w(e.data))}))}},S=function(e){return function(t){return function(e){return x.a.get("/api/albums",e)}(e).then((function(e){return t((n=e.data,{type:y,albums:n}));var n}))}},E=function(e){return function(t){return function(e){return x.a.patch("/api/albums/cover",e)}(e).then((function(e){return t(w(e.data))}))}},A=function(e){e?x.a.defaults.headers.common.Authorization=e:delete x.a.defaults.headers.common.Authorization},k=n(58),N="RECEIVE_CURRENT_USER",T="RECEIVE_SESSION_ERRORS",D="RECEIVE_USER_LOGOUT",U="RECEIVE_USER_SIGN_IN",z=function(e){return{type:T,errors:e}},R=function(e){return function(t){return(n=e,x.a.post("/api/users",n)).then((function(){return t({type:U})}),(function(e){return t(z(e.response.data))}));var n}},_=function(e){return function(t){return(n=e,x.a.post("/api/users/login",n)).then((function(e){var n=e.data.token;localStorage.setItem("jwtToken",n),A(n);var r=Object(k.a)(n);t({type:N,currentUser:r})})).catch((function(e){t(z(e.response.data))}));var n}},L=function(){return function(e){localStorage.removeItem("jwtToken"),A(!1),e({type:D})}},P=n(21),F=(n(152),n(88)),B=n(205),M=n(206),V=n(172),W=n(216),G=n(203),H=n(171),J=(n(153),Object(F.a)((function(e){return{container:{background:"#0077b6",maxWidth:"500px",height:"inherit"},header:{fontSize:"50px",marginTop:"10px",marginBottom:"10px"},button:{width:"450px",height:"50px",marginTop:"20px"}}})));var Y=Object(b.i)((function(e){var t=J(),n=Object(b.h)().path,i=Object(a.useState)(""),c=Object(P.a)(i,2),s=c[0],u=c[1],l=Object(a.useState)(""),j=Object(P.a)(l,2),d=j[0],h=j[1],p=function(e){return function(t){e(t.currentTarget.value)}};return Object(r.jsxs)(G.a,{className:t.container,children:[Object(r.jsx)(H.a,{variant:"h6",className:t.header,children:"/login"===n?"Welcome Back":"Register"}),Object(r.jsxs)("form",{onSubmit:function(){var t={username:s,password:d};e.formType(t).then((function(){"signup"===e.type&&e.login(t)})),h("")},style:{fontSize:"8px"},children:[Object(r.jsx)("input",{type:"text",value:s,onChange:p(u),placeholder:"Username",className:"sessionInput"}),Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"password",className:"sessionInput",value:d,onChange:p(h),placeholder:"Password"}),Object(r.jsx)("br",{}),Object(r.jsx)(o.b,{className:"session-links",to:"/login"===n?"/signup":"/login",children:"/login"===n?"Need an account?":"Already have an account?"}),Object(r.jsx)(V.a,{type:"submit",className:t.button,children:"submit"})]})]})})),q=Object(u.b)((function(e){return{errors:e.errors.session,type:"login"}}),(function(e){return{formType:function(t){return e(_(t))}}}))(Y),K=Object(u.b)((function(e){return{signedIn:e.session.isSignedIn,errors:e.errors.session,type:"signup"}}),(function(e){return{formType:function(t){return e(R(t))},login:function(t){return e(_(t))}}}))(Y);var Q=Object(u.b)((function(e){return{user:e.session.user}}),(function(e){return{logout:function(){return e(L())}}}))((function(e){var t=J();return Object(r.jsxs)(G.a,{className:t.container,children:[Object(r.jsx)(H.a,{variant:"h6",className:t.header,style:{fontSize:"40px"},children:"Welcome Back ".concat(e.user.username,"!")}),Object(r.jsx)(V.a,{className:t.button,onClick:e.logout,children:"Logout?"})]})})),X=Object(g.a)({typography:{fontFamily:"'Playfair Display', serif",button:{fontSize:"25px",height:"30px",padding:"10px",margin:"0px"}}}),Z=Object(F.a)((function(e){return{button:{padding:10,margin:0,display:"flex"},grid:{height:50},modal:{display:"flex",flexDirection:"row-reverse"}}}));var $=function(e){var t=Z(),n=Object(b.h)(),i=n.path,c=(n.url,Object(b.g)()),s=Object(a.useCallback)((function(){return c.push("/")}));Object(a.useEffect)((function(){var t=e.user?e.user.id:0;e.fetchAllAlbums({userId:t})}));var u,l="/login"===i||"/signup"===i,j="/@me"===i;u="/login"===i?Object(r.jsx)(q,{}):Object(r.jsx)(K,{});var d=Object(a.useState)(l),h=Object(P.a)(d,2),p=h[0],f=h[1],g=Object(a.useState)(j),O=Object(P.a)(g,2),x=O[0],v=O[1];return Object(a.useEffect)((function(){f("/login"===i||"/signup"===i),v("/@me"===i)})),Object(r.jsx)(m.a,{theme:X,children:Object(r.jsx)("div",{className:"nav-bar",children:Object(r.jsxs)(B.a,{container:!0,direction:"row",justify:"space-between",alignContent:"center",alignItems:"center",space:1,className:t.grid,children:[Object(r.jsx)(B.a,{container:!0,item:!0,sm:3,alignItems:"center",justify:"center",children:Object(r.jsx)("p",{style:{fontFamily:"'Playfair Display', serif",fontSize:"30px"},children:"Photo Dojo"})}),e.loggedIn?Object(r.jsxs)(B.a,{container:!0,item:!0,xs:4,spacing:1,alignItems:"center",justify:"center",children:[Object(r.jsxs)(M.a,{variant:"contained",size:"medium",disableElevation:!0,children:[Object(r.jsx)(o.b,{to:"/@me/albums",style:{textDecoration:"none"},children:Object(r.jsx)(V.a,{type:"button",className:t.button,children:"My Albums"})}),Object(r.jsx)(o.b,{to:"/signup",style:{textDecoration:"none"},children:Object(r.jsx)(V.a,{type:"button",className:t.button,children:"Home"})}),Object(r.jsx)(o.b,{to:"/@me",style:{textDecoration:"none"},children:Object(r.jsx)(V.a,{type:"button",className:t.button,children:"profile"})})]}),Object(r.jsx)(W.a,{anchor:"right",open:x,SlideProps:{in:x,direction:"right"},onClose:s,className:t.modal,children:Object(r.jsx)(Q,{})})]}):Object(r.jsxs)(B.a,{container:!0,item:!0,xs:3,spacing:0,alignItems:"center",justify:"center",children:[Object(r.jsxs)(M.a,{variant:"contained",size:"medium",disableElevation:!0,children:[Object(r.jsx)(o.b,{to:"/login",style:{textDecoration:"none"},children:Object(r.jsx)(V.a,{type:"button",className:t.button,children:"Log In"})}),Object(r.jsx)(o.b,{to:"/signup",style:{textDecoration:"none"},children:Object(r.jsx)(V.a,{type:"button",className:t.button,children:"Sign Up"})})]}),Object(r.jsx)(W.a,{anchor:"right",open:p,SlideProps:{in:p,direction:"right"},onClose:s,className:t.modal,children:u})]})]})})},"")},ee=Object(u.b)((function(e,t){return{loggedIn:e.session.isAuthenticated,user:e.session.user}}),(function(e){return{logout:function(){return e(L())},fetchAllAlbums:function(t){return e(S(t))}}}))($),te="RECEIVE_IMAGES",ne="RECEIVE_UTIL_IMAGES",re=function(){return function(e){return x.a.get("/api/recentimages").then((function(t){return e((n=t.data,{type:ne,images:n}));var n}))}},ae=function(e){return function(t){return function(e){return x.a.post("/api/images",e)}(e).then((function(e){return t(function(e){return{type:te,images:e}}(e.data))}))}},ie=n(207),ce=n(77),se=n(211),ue=n(209),oe=n(210),le=n(213),je=n(215),be=Object(F.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{width:1500,height:"auto",backgroundSize:"contain"}}}));function de(e){var t=e.tileData,n=be();function a(e){var t=e.img.height/e.img.width;return t<.75?6:t<1?4:2}return Object(r.jsx)("div",{className:n.root,children:Object(r.jsx)(ue.a,{cellHeight:"320",className:n.gridList,cols:12,children:t.map((function(e){return Object(r.jsx)(oe.a,{cols:a(e),children:Object(r.jsx)("img",{src:e.img.src,alt:e.title})},e.img.src)}))})})}var he=Object(F.a)((function(e){return{button:{padding:10,margin:0,width:"200px",fontSize:"20px"},grid:{height:50},modal:{display:"flex",flexDirection:"row-reverse"},root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{width:1500,height:"auto",backgroundSize:"contain"}}}));function pe(e,t){return Object(r.jsx)("div",{className:t.root,children:Object(r.jsx)(ue.a,{cellHeight:"320",className:t.gridList,cols:12,children:e.albums.map((function(e,t){return Object(r.jsx)(oe.a,{cols:3,children:fe({title:e.title,imagePath:e.cover_path})},t)}))})})}function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e.preventDefault()};return Object(r.jsxs)("div",{children:[Object(r.jsx)("img",{loading:"lazy",src:e.imagePath,onLoad:function(t){var n=t.currentTarget.width,r=t.currentTarget.height,a=n<r?1:r/n,i=n<r?n/r:1,c=e.size?e.size:260;t.currentTarget.width=c*i,t.currentTarget.height=c*a},onClick:t}),Object(r.jsx)(H.a,{variant:"h6",children:e.title?e.title:null})]})}var ge=Object(b.i)((function(e){var t,n=he();t=e.creating.cover_path?"images":null,!e.creating.cover_path&&e.creating.id&&(t="uploadCover");var i=Object(a.useState)(t),c=Object(P.a)(i,2),s=c[0],u=c[1],o=Object(a.useState)({title:"",private:!1}),l=Object(P.a)(o,2),j=l[0],b=l[1],d=Object(a.useState)(e.creating.cover_path),h=Object(P.a)(d,2),p=h[0],f=h[1],g=Object(a.useState)([]),m=Object(P.a)(g,2),O=m[0],x=m[1],v=Object(a.useState)([]),y=Object(P.a)(v,2),I=y[0],w=y[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(ee,{}),Object(r.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:function(){switch(s){case"uploadCover":return function(e,t,n,a,i){return Object(r.jsxs)("div",{style:{margin:"20px"},children:[Object(r.jsxs)(H.a,{style:{margin:"20px"},children:["Upload cover for ".concat(e.creating.title),Object(r.jsx)("br",{})]}),Object(r.jsx)("input",{type:"file",value:"",multiple:!0,onChange:function(e){var t=new FileReader,r=e.currentTarget.files[0];t.onloadend=function(){return n({image:{imageUrl:t.result,imageFile:r},file:r})},r&&t.readAsDataURL(r)}}),Object(r.jsx)("br",{}),t?Object(r.jsxs)("div",{children:[Object(r.jsx)("br",{}),fe({imagePath:t.image.imageUrl,title:e.creating.title}),Object(r.jsx)("br",{}),Object(r.jsx)(V.a,{className:i.button,size:"large",onClick:function(r){r.preventDefault();var i=new FormData;i.append("albumId",e.creating.id),i.append("albums[photos][]",t.file),e.uploadCover(i).then((function(){a("images"),n("")}))},children:"Upload"})]}):null]})}(e,p,f,u,n);case"newAlbum":return function(e,t,n,a){return Object(r.jsxs)("div",{style:{margin:"20px"},children:[Object(r.jsxs)(H.a,{style:{margin:"20px"},children:["Album Title",Object(r.jsx)("br",{}),Object(r.jsx)(le.a,{value:t.title,onInput:function(e){n({title:e.target.value,private:t.private})}})]}),Object(r.jsxs)(H.a,{style:{margin:"20px"},children:["Make Album Private?",Object(r.jsx)(je.a,{value:"checkedA",inputProps:{"aria-label":"Checkbox A"},onClick:function(){n({title:t.title,private:!t.private})}})]}),Object(r.jsx)(V.a,{size:"large",onClick:function(n){if(n.preventDefault(),""===t.title)return null;var r={title:t.title,public:!t.private,ownerId:e.user.id};e.createAlbum(r).then((function(){a("uploadCover")}))},children:"Create"})]})}(e,j,b,u);case"images":return function(e,t,n,a,i,c){function s(e){var r=i;r.push(e),c(Object(ce.a)(r));var a=new FileReader;a.onloadend=function(){var e=t;e.push(a.result),n(Object(ce.a)(e))},a.readAsDataURL(e)}function u(){var s=t.map((function(t,n){var r=new Image;return r.src=t,{img:r,title:n,author:e.user.username}}));return Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:[Object(r.jsx)("br",{}),Object(r.jsx)(V.a,{onClick:function(t){t.preventDefault();var r=new FormData;r.append("albumId",e.creating.id);for(var s=0;s<i.length;s++)r.append("albums[photos][]",i[s]);e.upload(r).then((function(){n([]),c([]),a(""),e.clearAlbum()}))},size:"large",children:"Upload"}),Object(r.jsx)("br",{}),Object(r.jsx)(de,{tileData:s})]})}return Object(r.jsxs)("div",{style:{margin:"20px"},children:[Object(r.jsxs)(H.a,{style:{margin:"20px"},children:["Add images",Object(r.jsx)("br",{})]}),fe({imagePath:e.creating.cover_path,title:e.creating.title}),Object(r.jsx)("input",{type:"file",onChange:function(e){for(var t=e.currentTarget.files,n=0;n<t.length;n++){s(t[n])}e.currentTarget.id=""===e.currentTarget.id?1:e.currentTarget.id++},multiple:!0}),t.length>0?u():null]})}(e,O,x,u,I,w);default:return function(e,t,n){return Object(r.jsxs)(H.a,{variant:"h3",children:[0===e.albums.length?"You haven't created any albums yet!":"Your albums",Object(r.jsx)("br",{}),Object(r.jsx)("div",{style:{fontSize:"20px"},children:Object(r.jsx)(se.a,{href:"#",onClick:function(e){e.preventDefault(),t("newAlbum")},children:" Create New Album"})}),e.albums.length>0?pe(e,n):null]})}(e,u,n)}}()})]})})),me=n(102),Oe=n.n(me);function xe(e){return Object(r.jsxs)(ie.a,{height:"400",children:[Object(r.jsx)("br",{}),Object(r.jsx)("div",{style:{height:"450px"},children:fe(e)}),Object(r.jsx)(V.a,{className:"CheckButton",children:"Check it out!"})]})}var ve=function(e){var t=[],n=Object(a.useState)(!1),i=Object(P.a)(n,2),c=i[0],s=i[1];if(Object(a.useEffect)((function(){c||(e.fetchUtilImages(),s(!0))})),0===t.length&&e.albums.length>0)for(var u=e.albums.length-1;u>=e.albums.length-10;u--){var o={title:e.albums[u].title,imagePath:e.albums[u].cover_path};t.push(o)}return Object(r.jsxs)("div",{style:{textAlign:"center",marginTop:"10px"},children:[Object(r.jsx)(H.a,{variant:"h3",children:"Trending Albums"}),Object(r.jsx)("br",{}),Object(r.jsx)(Oe.a,{children:t.map((function(e,t){return Object(r.jsx)(xe,Object(j.a)(Object(j.a)({},e),{},{size:"400"}),t)}))}),c?function(t){var n=t.map((function(t,n){var r=new Image;return r.src=t,{img:r,title:n,author:e.user.username}}));return Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:[Object(r.jsx)("br",{}),Object(r.jsx)(de,{tileData:n})]})}(e.publicImages):null]})},ye=Object(u.b)((function(e){return{loggedIn:e.session.isAuthenticated,user:e.session.user,albums:Object.values(e.entities.albums),publicImages:e.utils.images.map((function(e){return e.path}))}}),(function(e){return{fetchUtilImages:function(){return e(re())}}}))(ve);var Ie=function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)(ee,{}),Object(r.jsx)(ye,{})]})},we=Object(u.b)((function(e){return{user:e.session.user,albums:Object.values(e.entities.albums).filter((function(t){return t.ownerid===e.session.user.id})),creating:e.utils.album}}),(function(e){return{upload:function(t){return e(ae(t))},createAlbum:function(t){return e(C(t))},uploadCover:function(t){return e(E(t))},clearAlbum:function(){return e({type:I})}}}))(ge),Ce=Object(g.a)({typography:{fontFamily:"'Playfair Display', serif",button:{fontSize:"8px",height:"14px",padding:"0px",margin:"0px"}}}),Se=function(){return Object(r.jsx)("div",{children:Object(r.jsx)(f.a,{children:Object(r.jsx)(m.a,{theme:Ce,children:Object(r.jsxs)(b.d,{children:[Object(r.jsx)(b.b,{exact:!0,path:"/",component:Ie}),Object(r.jsx)(h,{exact:!0,path:"/login",component:Ie}),Object(r.jsx)(h,{exact:!0,path:"/signup",component:Ie}),Object(r.jsx)(p,{exact:!0,path:"/@me",component:Ie}),Object(r.jsx)(p,{exact:!0,path:"/@me/albums",component:we})]})})})})},Ee=function(e){var t=e.store;return Object(r.jsx)(u.a,{store:t,children:Object(r.jsx)(o.a,{children:Object(r.jsx)(Se,{})})})},Ae=n(23),ke=n(103),Ne=n(104),Te=n.n(Ne),De={isAuthenticated:!1,user:{}},Ue=[],ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case T:return t.errors;case N:return Ue;default:return e}},Re=Object(Ae.c)({session:ze}),_e=n(57),Le=Object(Ae.c)({images:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case te:return Object(j.a)(Object(j.a)({},e),t.images);default:return e}},albums:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return t.albums;case v:var n=t.album.id,r=Object(_e.a)({},n,t.album);return Object.assign({},e,r);default:return e}}}),Pe=Object(Ae.c)({album:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return t.album;case I:return{};default:return e}},images:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne:return t.images;default:return e}}}),Fe=Object(Ae.c)({session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(j.a)(Object(j.a)({},e),{},{isAuthenticated:!!t.currentUser,user:t.currentUser});case D:return{isAuthenticated:!1,user:{}};case U:return Object(j.a)(Object(j.a)({},e),{},{isSignedIn:!0});default:return e}},errors:Re,entities:Le,utils:Pe}),Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(Ae.d)(Fe,e,Object(Ae.a)(ke.a,Te.a))};document.addEventListener("DOMContentLoaded",(function(){var e;if(localStorage.jwtToken){A(localStorage.jwtToken);var t=Object(k.a)(localStorage.jwtToken);e=Be({session:{isAuthenticated:!0,user:t}});Date.now()}else e=Be({});var n=document.getElementById("root");c.a.render(Object(r.jsx)(Ee,{store:e}),n)})),s()}},[[168,1,2]]]);
//# sourceMappingURL=main.30afb75b.chunk.js.map